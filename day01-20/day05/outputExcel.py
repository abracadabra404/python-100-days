import pandas as pd
from openpyxl import Workbook
from openpyxl.utils.dataframe import dataframe_to_rows

# 定义系统梳理模板内容
data = {
    "分类": [
        "基本信息", "基本信息", "基本信息", "基本信息", "基本信息", "基本信息",
        "架构与技术栈", "架构与技术栈", "架构与技术栈", "架构与技术栈", "架构与技术栈", "架构与技术栈", "架构与技术栈", "架构与技术栈",
        "依赖与接口", "依赖与接口", "依赖与接口", "依赖与接口", "依赖与接口",
        "安全与权限", "安全与权限", "安全与权限", "安全与权限", "安全与权限",
        "运维与监控", "运维与监控", "运维与监控", "运维与监控", "运维与监控",
        "问题与优化", "问题与优化", "问题与优化", "问题与优化"
    ],
    "字段名称": [
        "系统名称", "系统负责人", "所属部门", "系统类别", "上线时间", "系统重要性",
        "架构类型", "技术语言", "框架平台", "数据库", "中间件", "接入方式", "部署模式", "其他说明",
        "上游系统", "下游系统", "第三方依赖", "数据流向", "接口协议",
        "鉴权方式", "权限控制", "审计机制", "漏洞情况", "等保等级",
        "运维方式", "日志管理", "监控系统", "报警机制", "高可用性",
        "当前瓶颈", "技术债", "风险点", "优化方向"
    ],
    "说明": [
        "系统的唯一标识", "产品/技术负责人", "所属的业务或技术部门", "核心/支撑/辅助", "首次上线时间", "高/中/低重要性",
        "如单体、微服务、分布式等", "主开发语言", "如Spring Boot、Vue等", "使用的数据库类型和结构", "使用的缓存、消息队列等", "如API、MQ等", "如本地部署、K8s、云平台", "补充其他技术信息",
        "依赖哪些上游数据或服务", "服务于哪些系统或终端", "依赖的外部接口或SDK", "客户或敏感数据的流转路径", "HTTP、gRPC等协议",
        "如JWT、OAuth等", "菜单/功能/数据级权限控制", "是否记录操作日志", "是否定期扫描及处理", "是否已完成等保及等级",
        "是否有自动化部署与CI/CD", "日志采集、保留周期", "使用的监控系统", "告警的触发与通知机制", "是否主备、容灾等",
        "如性能瓶颈、模块复杂度高", "历史遗留问题、需重构模块", "如接口不稳定、人员依赖", "可改进方向"
    ]
}

# 转为 DataFrame
df = pd.DataFrame(data)

# 创建 Excel 文件
wb = Workbook()
ws = wb.active
ws.title = "系统梳理模板"

# 添加表头和数据
for row in dataframe_to_rows(df, index=False, header=True):
    ws.append(row)

# 设置列宽
column_widths = [15, 20, 60]
for i, width in enumerate(column_widths, start=1):
    ws.column_dimensions[chr(64 + i)].width = width

# 保存文件
output_path = "C:/Users/许亚西/Desktop/系统梳理模板.xlsx"
wb.save(output_path)

output_path
